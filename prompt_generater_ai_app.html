<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PromptForge â€” Intelligent Prompt Optimizer</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#070a12; --s:rgba(255,255,255,.04); --s2:rgba(255,255,255,.07);
  --b:rgba(255,255,255,.08); --text:#e6eeff; --muted:rgba(180,200,255,.45);
  --cyan:#3ef0ff; --blue:#5ba3ff; --purple:#9d7fff;
  --green:#3ddc84; --orange:#ff8c42; --pink:#ff5fa0;
  --yellow:#f5c842; --red:#ff5c5c;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--bg);color:var(--text);font-family:'Syne',sans-serif;min-height:100vh;}
body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse 70% 50% at 15% 5%,rgba(62,240,255,.055) 0%,transparent 55%),radial-gradient(ellipse 50% 35% at 85% 90%,rgba(157,127,255,.05) 0%,transparent 55%);pointer-events:none;z-index:0;}
body::after{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(62,240,255,.022) 1px,transparent 1px),linear-gradient(90deg,rgba(62,240,255,.022) 1px,transparent 1px);background-size:56px 56px;pointer-events:none;z-index:0;}

.app{position:relative;z-index:1;max-width:860px;margin:0 auto;padding:44px 20px 100px;}

/* HEADER */
header{text-align:center;margin-bottom:48px;animation:fadeDown .7s ease both;}
.badge{display:inline-flex;align-items:center;gap:7px;background:rgba(62,240,255,.07);border:1px solid rgba(62,240,255,.18);border-radius:100px;padding:5px 15px;font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--cyan);letter-spacing:2.5px;text-transform:uppercase;margin-bottom:18px;}
.badge::before{content:'';width:5px;height:5px;border-radius:50%;background:var(--cyan);animation:blink 2s infinite;}
h1{font-size:clamp(36px,6vw,64px);font-weight:800;line-height:.97;letter-spacing:-2px;background:linear-gradient(140deg,#fff 0%,#63b3ff 40%,#3ef0ff 65%,#a78bfa 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:12px;}
.sub{font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--muted);}

/* STEP LABELS */
.step-label{font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--muted);display:flex;align-items:center;gap:8px;margin-bottom:10px;}
.sn{width:20px;height:20px;border-radius:50%;background:rgba(62,240,255,.12);border:1px solid rgba(62,240,255,.25);color:var(--cyan);font-size:10px;display:flex;align-items:center;justify-content:center;font-family:'JetBrains Mono',monospace;flex-shrink:0;}

/* INPUT */
.input-wrap{position:relative;margin-bottom:16px;animation:fadeUp .7s .1s ease both;}
textarea{width:100%;min-height:110px;background:var(--s);border:1px solid var(--b);border-radius:16px;padding:18px 20px;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:14px;line-height:1.7;resize:vertical;outline:none;transition:border-color .3s,box-shadow .3s,background .3s;}
textarea::placeholder{color:rgba(180,200,255,.2);}
textarea:focus{border-color:rgba(62,240,255,.35);background:rgba(62,240,255,.025);box-shadow:0 0 0 3px rgba(62,240,255,.06);}
.char-pill{position:absolute;bottom:12px;right:14px;font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--muted);opacity:.5;}

/* ANALYSIS BADGE â€” shows after typing */
.analysis-strip{
  display:none;flex-wrap:wrap;gap:7px;align-items:center;
  padding:10px 14px;
  background:rgba(62,240,255,.04);
  border:1px solid rgba(62,240,255,.12);
  border-radius:12px;margin-bottom:24px;
  animation:fadeUp .4s ease both;
}
.analysis-strip.show{display:flex;}
.ana-label{font-family:'JetBrains Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:rgba(62,240,255,.5);margin-right:4px;}
.ana-tag{font-family:'JetBrains Mono',monospace;font-size:10px;padding:3px 10px;border-radius:100px;font-weight:500;}
.ana-domain  {background:rgba(91,163,255,.12); color:var(--blue);border:1px solid rgba(91,163,255,.25);}
.ana-intent  {background:rgba(157,127,255,.12);color:var(--purple);border:1px solid rgba(157,127,255,.25);}
.ana-tone    {background:rgba(61,220,132,.1);  color:var(--green);border:1px solid rgba(61,220,132,.2);}
.ana-audience{background:rgba(255,140,66,.1);  color:var(--orange);border:1px solid rgba(255,140,66,.2);}
.ana-output  {background:rgba(255,95,160,.1);  color:var(--pink);border:1px solid rgba(255,95,160,.2);}

/* MODEL GRID */
.model-grid-wrap{margin-bottom:24px;animation:fadeUp .7s .2s ease both;}
.model-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:9px;margin-top:10px;}
.m-btn{background:var(--s);border:1px solid var(--b);border-radius:13px;padding:13px 8px 11px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:7px;transition:all .22s ease;position:relative;overflow:hidden;}
.m-btn:hover{transform:translateY(-2px);background:var(--s2);}
.m-btn.active{transform:translateY(-2px);}
.m-btn.active::after{content:'';position:absolute;bottom:0;left:0;right:0;height:2.5px;border-radius:0 0 12px 12px;}
.m-btn[data-m="chatgpt"].active{border-color:rgba(61,220,132,.5);box-shadow:0 4px 18px rgba(61,220,132,.1);}
.m-btn[data-m="chatgpt"].active::after{background:var(--green);}
.m-btn[data-m="claude"].active{border-color:rgba(255,140,66,.5);box-shadow:0 4px 18px rgba(255,140,66,.1);}
.m-btn[data-m="claude"].active::after{background:var(--orange);}
.m-btn[data-m="gemini"].active{border-color:rgba(91,163,255,.5);box-shadow:0 4px 18px rgba(91,163,255,.1);}
.m-btn[data-m="gemini"].active::after{background:var(--blue);}
.m-btn[data-m="midjourney"].active{border-color:rgba(255,95,160,.5);box-shadow:0 4px 18px rgba(255,95,160,.1);}
.m-btn[data-m="midjourney"].active::after{background:var(--pink);}
.m-btn[data-m="llama"].active{border-color:rgba(157,127,255,.5);box-shadow:0 4px 18px rgba(157,127,255,.1);}
.m-btn[data-m="llama"].active::after{background:var(--purple);}
.m-btn[data-m="grok"].active{border-color:rgba(245,200,66,.5);box-shadow:0 4px 18px rgba(245,200,66,.1);}
.m-btn[data-m="grok"].active::after{background:var(--yellow);}
.m-icon{width:26px;height:26px;display:flex;align-items:center;justify-content:center;}
.m-icon svg{width:100%;height:100%;}
.m-name{font-size:11px;font-weight:700;color:var(--text);letter-spacing:.2px;text-align:center;}
.m-tick{position:absolute;top:6px;right:6px;width:14px;height:14px;border-radius:50%;border:1.5px solid var(--b);font-size:7px;color:transparent;display:flex;align-items:center;justify-content:center;transition:all .2s;}
.m-btn.active .m-tick{background:rgba(255,255,255,.1);border-color:rgba(255,255,255,.2);color:white;}

/* CHIPS */
.chips-wrap{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:28px;animation:fadeUp .7s .3s ease both;}
.chip{display:flex;align-items:center;gap:6px;background:var(--s);border:1px solid var(--b);border-radius:100px;padding:7px 13px;font-size:11px;font-weight:600;color:var(--muted);cursor:pointer;transition:all .2s;letter-spacing:.4px;user-select:none;}
.chip:hover{background:var(--s2);color:var(--text);}
.chip.on{background:rgba(62,240,255,.08);border-color:rgba(62,240,255,.3);color:var(--cyan);}
.chip svg{width:12px;height:12px;flex-shrink:0;}

/* GEN BUTTON */
.gen-row{display:flex;gap:10px;margin-bottom:44px;animation:fadeUp .7s .4s ease both;}
.btn-gen{flex:1;background:linear-gradient(120deg,#1a5fff,#0bbcd4);border:none;border-radius:14px;padding:17px 28px;color:white;font-family:'Syne',sans-serif;font-size:15px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:transform .2s,box-shadow .3s;letter-spacing:.3px;}
.btn-gen:hover{transform:translateY(-2px);box-shadow:0 12px 36px rgba(14,165,233,.4);}
.btn-gen:active{transform:translateY(0);}
.btn-gen.busy{pointer-events:none;opacity:.75;}
.spin{width:17px;height:17px;border:2px solid rgba(255,255,255,.3);border-top-color:white;border-radius:50%;animation:rot .65s linear infinite;display:none;}
.btn-gen.busy .spin{display:block;}
.btn-gen.busy .btn-txt,.btn-gen.busy .btn-ico{display:none;}
.btn-clear{background:var(--s);border:1px solid var(--b);border-radius:14px;padding:17px 18px;color:var(--muted);font-family:'Syne',sans-serif;font-size:13px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:7px;transition:all .2s;white-space:nowrap;}
.btn-clear:hover{background:rgba(255,92,92,.08);border-color:rgba(255,92,92,.3);color:var(--red);}

/* DIVIDER */
.divider{display:flex;align-items:center;gap:14px;margin:0 0 28px;opacity:0;transition:opacity .4s;}
.divider.show{opacity:1;}
.divider::before,.divider::after{content:'';flex:1;height:1px;background:var(--b);}
.divider span{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;white-space:nowrap;}

/* RESULT CARDS */
.results{display:flex;flex-direction:column;gap:18px;}
.r-card{background:var(--s);border:1px solid var(--b);border-radius:18px;overflow:hidden;animation:slideIn .45s ease both;transition:border-color .3s,box-shadow .3s;}
.r-card:hover{border-color:var(--ca,rgba(255,255,255,.13));box-shadow:0 8px 30px rgba(0,0,0,.3);}
.r-card[data-m="chatgpt"]    {--ca:rgba(61,220,132,.35); --cc:var(--green);}
.r-card[data-m="claude"]     {--ca:rgba(255,140,66,.35);  --cc:var(--orange);}
.r-card[data-m="gemini"]     {--ca:rgba(91,163,255,.35);  --cc:var(--blue);}
.r-card[data-m="midjourney"] {--ca:rgba(255,95,160,.35);  --cc:var(--pink);}
.r-card[data-m="llama"]      {--ca:rgba(157,127,255,.35); --cc:var(--purple);}
.r-card[data-m="grok"]       {--ca:rgba(245,200,66,.35);  --cc:var(--yellow);}
.r-card::before{content:'';display:block;height:2px;background:var(--cc,rgba(255,255,255,.15));}

.c-head{display:flex;align-items:center;justify-content:space-between;padding:13px 18px 12px;border-bottom:1px solid var(--b);background:var(--s2);}
.c-model{display:flex;align-items:center;gap:10px;}
.c-logo{width:30px;height:30px;border-radius:8px;background:rgba(255,255,255,.06);display:flex;align-items:center;justify-content:center;padding:4px;flex-shrink:0;}
.c-logo svg{width:100%;height:100%;}
.c-mname{font-size:14px;font-weight:700;color:var(--cc);}
.c-tag{font-family:'JetBrains Mono',monospace;font-size:9px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);padding:2px 7px;border-radius:6px;color:var(--muted);margin-left:6px;}
.c-actions{display:flex;gap:7px;}
.a-btn{background:rgba(255,255,255,.05);border:1px solid var(--b);border-radius:8px;padding:5px 10px;color:var(--muted);font-family:'JetBrains Mono',monospace;font-size:10px;cursor:pointer;display:flex;align-items:center;gap:5px;transition:all .2s;}
.a-btn:hover{background:rgba(255,255,255,.09);color:var(--text);}
.a-btn.ok{background:rgba(61,220,132,.1);border-color:rgba(61,220,132,.3);color:var(--green);}

/* INSIGHT BAND â€” shows what the brain detected */
.insight-band{padding:10px 18px;border-bottom:1px dashed rgba(255,255,255,.05);display:flex;flex-wrap:wrap;gap:6px;align-items:center;background:rgba(0,0,0,.15);}
.ins-lbl{font-family:'JetBrains Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:rgba(62,240,255,.4);margin-right:4px;}
.ins-tag{font-family:'JetBrains Mono',monospace;font-size:9px;padding:2px 8px;border-radius:6px;color:var(--cc);background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);}

/* SECTIONS */
.section-raw{padding:14px 20px;border-bottom:1px dashed rgba(255,255,255,.055);}
.section-opt{padding:18px 20px;}
.sec-label{font-size:9px;font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-bottom:8px;display:flex;align-items:center;gap:6px;}
.sec-label.lbl-raw{color:var(--muted);}
.sec-label.lbl-opt{color:var(--cc);}
.sec-label svg{width:11px;height:11px;}
.raw-text{font-family:'JetBrains Mono',monospace;font-size:12px;color:rgba(180,200,255,.45);line-height:1.6;font-style:italic;}
.opt-text{font-family:'JetBrains Mono',monospace;font-size:13px;line-height:1.9;color:rgba(218,232,255,.9);white-space:pre-wrap;word-break:break-word;}

.arrow-row{display:flex;align-items:center;gap:10px;padding:0 20px;margin:2px 0;}
.a-line{flex:1;height:1px;background:var(--b);}
.a-badge{display:flex;align-items:center;gap:5px;background:rgba(62,240,255,.07);border:1px solid rgba(62,240,255,.18);border-radius:100px;padding:3px 10px;font-size:10px;font-family:'JetBrains Mono',monospace;color:var(--cyan);white-space:nowrap;}

.c-foot{padding:9px 18px;border-top:1px solid var(--b);display:flex;align-items:center;gap:14px;flex-wrap:wrap;}
.stat{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--muted);display:flex;align-items:center;gap:4px;}
.stat b{color:var(--cyan);font-weight:500;}

/* EMPTY */
.empty-state{text-align:center;padding:52px 20px;animation:fadeUp .7s .5s ease both;}
.empty-icon{width:64px;height:64px;border-radius:18px;background:rgba(62,240,255,.06);border:1px solid rgba(62,240,255,.12);display:flex;align-items:center;justify-content:center;margin:0 auto 16px;font-size:26px;}
.empty-title{font-size:18px;font-weight:700;margin-bottom:8px;}
.empty-sub{font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--muted);line-height:1.8;}
.ex-chips{display:flex;flex-wrap:wrap;gap:7px;justify-content:center;margin-top:18px;}
.ex-chip{font-family:'JetBrains Mono',monospace;font-size:11px;padding:6px 13px;background:var(--s);border:1px solid var(--b);border-radius:100px;color:var(--muted);cursor:pointer;transition:all .2s;}
.ex-chip:hover{background:var(--s2);color:var(--text);border-color:rgba(62,240,255,.3);}

@keyframes fadeDown{from{opacity:0;transform:translateY(-18px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeUp  {from{opacity:0;transform:translateY(18px)} to{opacity:1;transform:translateY(0)}}
@keyframes slideIn {from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:translateY(0)}}
@keyframes rot     {to{transform:rotate(360deg)}}
@keyframes blink   {0%,100%{opacity:1;transform:scale(1)}50%{opacity:.4;transform:scale(.75)}}

@media(max-width:580px){.model-grid{grid-template-columns:repeat(3,1fr);}.gen-row{flex-direction:column;}}
@media(max-width:360px){.model-grid{grid-template-columns:repeat(2,1fr);}}
</style>
</head>
<body>
<div class="app">

<header>
  <div class="badge">PromptForge v4 Â· Intelligent Brain</div>
  <h1>Smart Prompt<br>Optimizer</h1>
  <p class="sub">// Type anything. The brain reads it, understands it, and crafts a powerful prompt.</p>
</header>

<!-- STEP 1: Input -->
<div class="input-wrap">
  <div class="step-label"><span class="sn">1</span> Describe what you want (anything, simple or complex)</div>
  <textarea id="raw" placeholder="E.g. write a cover letter for a software engineer job, explain how black holes form, build a React login page, create a fantasy forest painting..." maxlength="1200"></textarea>
  <div class="char-pill" id="chars">0 / 1200</div>
</div>

<!-- LIVE ANALYSIS STRIP -->
<div class="analysis-strip" id="anaStrip">
  <span class="ana-label">Detected â†’</span>
  <span class="ana-tag ana-domain" id="anaDomain"></span>
  <span class="ana-tag ana-intent" id="anaIntent"></span>
  <span class="ana-tag ana-tone"   id="anaTone"></span>
  <span class="ana-tag ana-audience" id="anaAudience"></span>
  <span class="ana-tag ana-output" id="anaOutput"></span>
</div>

<!-- STEP 2: Models -->
<div class="model-grid-wrap">
  <div class="step-label"><span class="sn">2</span> Pick your target AI(s)</div>
  <div class="model-grid">

    <button class="m-btn active" data-m="chatgpt">
      <div class="m-icon"><svg viewBox="0 0 41 41" fill="white"><path d="M37.532 16.87a9.963 9.963 0 0 0-.856-8.184 10.078 10.078 0 0 0-10.855-4.835 9.964 9.964 0 0 0-6.15-3.765 10.079 10.079 0 0 0-11.498 4.96 9.956 9.956 0 0 0-6.671 4.804 10.08 10.08 0 0 0 1.24 11.817 9.965 9.965 0 0 0 .856 8.185 10.079 10.079 0 0 0 10.855 4.835 9.965 9.965 0 0 0 6.15 3.765 10.079 10.079 0 0 0 11.498-4.96 9.956 9.956 0 0 0 6.671-4.804 10.079 10.079 0 0 0-1.24-11.816zm-17.151 23.707a7.461 7.461 0 0 1-4.787-1.735c.061-.033.168-.091.237-.134l7.943-4.587a1.324 1.324 0 0 0 .666-1.148V22.61l3.356 1.938a.122.122 0 0 1 .066.092v9.299a7.505 7.505 0 0 1-7.481 7.538zm-16.075-6.899a7.46 7.46 0 0 1-.894-5.023c.06.036.162.099.237.141l7.943 4.587a1.324 1.324 0 0 0 1.332 0l9.699-5.602v3.876a.12.12 0 0 1-.048.103l-8.032 4.636a7.504 7.504 0 0 1-10.237-2.718zm-2.09-17.51a7.458 7.458 0 0 1 3.897-3.286 73.928 73.928 0 0 0-.001.278v9.175c0 .47.252.906.666 1.148l9.699 5.601-3.357 1.938a.12.12 0 0 1-.114.012L8.048 25.497a7.503 7.503 0 0 1-5.832-8.429zm27.556 6.437-9.699-5.602 3.356-1.937a.12.12 0 0 1 .114-.012l8.048 4.648a7.498 7.498 0 0 1-1.158 13.528v-9.453a1.324 1.324 0 0 0-.661-1.172zm3.339-5.033c-.059-.037-.162-.099-.236-.141l-7.944-4.587a1.325 1.325 0 0 0-1.332 0l-9.698 5.602v-3.876a.12.12 0 0 1 .048-.103l8.031-4.635a7.499 7.499 0 0 1 11.131 7.74zm-21.063 6.929-3.356-1.938a.121.121 0 0 1-.066-.092v-9.299a7.498 7.498 0 0 1 12.268-5.803 6.268 6.268 0 0 0-.236.134l-7.944 4.587a1.325 1.325 0 0 0-.666 1.148v11.263zm1.822-3.943 4.313-2.49 4.314 2.49v4.979l-4.314 2.49-4.313-2.49V20.758z"/></svg></div>
      <div class="m-name">ChatGPT</div><div class="m-tick">âœ“</div>
    </button>

    <button class="m-btn active" data-m="claude">
      <div class="m-icon"><svg viewBox="0 0 80 80" fill="none"><path d="M40 8L47.2 32.8L72 25.6L54.4 44L72 62.4L47.2 55.2L40 80L32.8 55.2L8 62.4L25.6 44L8 25.6L32.8 32.8L40 8Z" fill="#D4A574"/></svg></div>
      <div class="m-name">Claude</div><div class="m-tick">âœ“</div>
    </button>

    <button class="m-btn" data-m="gemini">
      <div class="m-icon"><svg viewBox="0 0 28 28"><defs><linearGradient id="gg" x1="0" y1="0" x2="28" y2="28" gradientUnits="userSpaceOnUse"><stop offset="0%" stop-color="#4285F4"/><stop offset="50%" stop-color="#9B72FF"/><stop offset="100%" stop-color="#EA4335"/></linearGradient></defs><path d="M14 28C14 26.06 13.63 24.24 12.88 22.54C12.16 20.84 11.17 19.36 9.91 18.1C8.65 16.84 7.16 15.85 5.46 15.12C3.76 14.37 1.94 14 0 14C1.94 14 3.76 13.64 5.46 12.91C7.16 12.17 8.65 11.17 9.91 9.91C11.17 8.65 12.16 7.16 12.88 5.46C13.63 3.76 14 1.94 14 0C14 1.94 14.36 3.76 15.09 5.46C15.83 7.16 16.84 8.65 18.1 9.91C19.36 11.17 20.84 12.17 22.54 12.91C24.24 13.64 26.06 14 28 14C26.06 14 24.24 14.37 22.54 15.12C20.84 15.85 19.36 16.84 18.1 18.1C16.84 19.36 15.83 20.84 15.09 22.54C14.36 24.24 14 26.06 14 28Z" fill="url(#gg)"/></svg></div>
      <div class="m-name">Gemini</div><div class="m-tick">âœ“</div>
    </button>

    <button class="m-btn" data-m="midjourney">
      <div class="m-icon"><svg viewBox="0 0 100 100"><circle cx="50" cy="50" r="8" fill="white"/><circle cx="50" cy="50" r="38" fill="none" stroke="white" stroke-width="5"/><line x1="50" y1="12" x2="50" y2="30" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="50" y1="70" x2="50" y2="88" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="12" y1="50" x2="30" y2="50" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="70" y1="50" x2="88" y2="50" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="23" y1="23" x2="36" y2="36" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="64" y1="64" x2="77" y2="77" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="77" y1="23" x2="64" y2="36" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="36" y1="64" x2="23" y2="77" stroke="white" stroke-width="5" stroke-linecap="round"/></svg></div>
      <div class="m-name">Midjourney</div><div class="m-tick">âœ“</div>
    </button>

    <button class="m-btn" data-m="llama">
      <div class="m-icon"><svg viewBox="0 0 60 30"><defs><linearGradient id="mg" x1="0" y1="0" x2="60" y2="30" gradientUnits="userSpaceOnUse"><stop offset="0%" stop-color="#0668E1"/><stop offset="100%" stop-color="#0099FF"/></linearGradient></defs><path d="M7 15C7 8.37 10.13 3 14.5 3C17.63 3 20.06 5.16 22.5 9.5L30 22.8L37.5 9.5C39.94 5.16 42.37 3 45.5 3C49.87 3 53 8.37 53 15C53 21.63 49.87 27 45.5 27C42.37 27 39.94 24.84 37.5 20.5L30 7.2L22.5 20.5C20.06 24.84 17.63 27 14.5 27C10.13 27 7 21.63 7 15Z" fill="none" stroke="url(#mg)" stroke-width="4.5" stroke-linejoin="round"/></svg></div>
      <div class="m-name">Llama</div><div class="m-tick">âœ“</div>
    </button>

    <button class="m-btn" data-m="grok">
      <div class="m-icon"><svg viewBox="0 0 24 24" fill="white"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-4.714-6.231-5.401 6.231H2.748l7.73-8.835L1.254 2.25H8.08l4.253 5.622 5.911-5.622zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></div>
      <div class="m-name">Grok</div><div class="m-tick">âœ“</div>
    </button>
  </div>
</div>

<!-- STEP 3: Options -->
<div class="chips-wrap">
  <div class="step-label" style="width:100%"><span class="sn">3</span> Tune the output</div>
  <button class="chip on" data-opt="detailed">
    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M2 3.5h12v1.5H2zm0 4h12v1.5H2zm0 4h8v1.5H2z"/></svg>Depth
  </button>
  <button class="chip on" data-opt="roleplay">
    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 8a3 3 0 100-6 3 3 0 000 6zm-5 6a5 5 0 0110 0H3z"/></svg>Expert Role
  </button>
  <button class="chip on" data-opt="examples">
    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M6 2h8v2H6zm0 5h8v2H6zm0 5h8v2H6zM2 2h2v2H2zm0 5h2v2H2zm0 5h2v2H2z"/></svg>Examples
  </button>
  <button class="chip on" data-opt="steps">
    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M2 2h2v2H2zm4 .5h8V4H6zm-4 4h2v2H2zm4 .5h8V8H6zm-4 4h2v2H2zm4 .5h8v1H6z"/></svg>Step-by-step
  </button>
  <button class="chip on" data-opt="format">
    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M1 2h14v1.5H1zm2 4h10v1.5H3zm3 4h4v1.5H6z"/></svg>Format
  </button>
  <button class="chip" data-opt="constraints">
    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a5 5 0 100 10A5 5 0 008 1zm1 7.5H7V5h2v3.5zm0-5H7V2h2v1.5z"/></svg>Constraints
  </button>
</div>

<!-- STEP 4: Generate -->
<div class="gen-row">
  <button class="btn-gen" id="genBtn" onclick="generate()">
    <span class="spin"></span>
    <span class="btn-ico">âš¡</span>
    <span class="btn-txt">Optimize My Prompt</span>
  </button>
  <button class="btn-clear" onclick="clearAll()">
    <svg width="13" height="13" viewBox="0 0 16 16" fill="currentColor"><path d="M6 2l1-1h2l1 1h3v2H3V2h3zm-3 3h10l-1 9H4L3 5zm3 2v5h1V7H6zm3 0v5h1V7H9z"/></svg>Clear
  </button>
</div>

<div class="divider" id="divider"><span>âœ¦ Optimized Prompts</span></div>

<div class="results" id="results">
  <div class="empty-state">
    <div class="empty-icon">ğŸ§ </div>
    <div class="empty-title">Intelligent Brain â€” Ready</div>
    <div class="empty-sub">
      Type any idea. The brain detects your <strong style="color:var(--blue)">domain</strong>,
      <strong style="color:var(--purple)">intent</strong>, <strong style="color:var(--green)">tone</strong>,
      and <strong style="color:var(--orange)">audience</strong> â€” then builds a powerful,
      context-aware prompt for every AI you select.
    </div>
    <div class="ex-chips">
      <span class="ex-chip" onclick="tryExample(this)">Write a cover letter for a UX designer role</span>
      <span class="ex-chip" onclick="tryExample(this)">Explain quantum entanglement simply</span>
      <span class="ex-chip" onclick="tryExample(this)">Build a React dashboard with dark mode</span>
      <span class="ex-chip" onclick="tryExample(this)">Create a fantasy dragon painting</span>
      <span class="ex-chip" onclick="tryExample(this)">Write a product launch email for a SaaS app</span>
      <span class="ex-chip" onclick="tryExample(this)">Analyze why startups fail in year one</span>
    </div>
  </div>
</div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PIKACHU AI ASSISTANT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<style>
/* â”€â”€ PokÃ©mon Fab Button â”€â”€ */
#pika-fab {
  position:fixed; bottom:28px; right:28px; z-index:9999;
  width:64px; height:64px; border-radius:50%; cursor:pointer;
  background:linear-gradient(135deg,#ffe04a,#ffb800);
  border:none; box-shadow:0 6px 28px rgba(255,184,0,.55);
  display:flex; align-items:center; justify-content:center;
  transition:transform .25s,box-shadow .25s;
  animation:pikaFloat 3s ease-in-out infinite;
}
#pika-fab:hover{transform:scale(1.12);box-shadow:0 10px 36px rgba(255,184,0,.75);}
@keyframes pikaFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}

#pika-fab .pika-badge {
  position:absolute; top:-4px; right:-4px;
  width:18px; height:18px; border-radius:50%;
  background:var(--cyan); border:2px solid var(--bg);
  font-size:9px; color:#000; font-weight:800;
  display:flex; align-items:center; justify-content:center;
  font-family:'JetBrains Mono',monospace;
  animation:blink 2s infinite;
}

/* â”€â”€ Chat Panel â”€â”€ */
#pika-panel {
  position:fixed; bottom:106px; right:28px; z-index:9998;
  width:360px; max-height:520px;
  background:#0d1120; border:1px solid rgba(255,184,0,.25);
  border-radius:22px; overflow:hidden;
  box-shadow:0 24px 60px rgba(0,0,0,.7), 0 0 0 1px rgba(255,184,0,.08);
  display:flex; flex-direction:column;
  transition:opacity .3s,transform .3s;
  transform-origin:bottom right;
}
#pika-panel.hidden{opacity:0;transform:scale(.88) translateY(12px);pointer-events:none;}

/* Panel header */
.pika-header {
  background:linear-gradient(120deg,#1a1200,#201a00);
  border-bottom:1px solid rgba(255,184,0,.15);
  padding:14px 16px; display:flex; align-items:center; gap:12px;
}
.pika-avatar {
  width:46px; height:46px; flex-shrink:0;
  background:linear-gradient(135deg,#ffe04a,#ffb800);
  border-radius:50%; display:flex; align-items:center; justify-content:center;
  box-shadow:0 3px 12px rgba(255,184,0,.4);
  position:relative; overflow:hidden;
}
.pika-avatar::after{
  content:''; position:absolute;
  inset:0; background:radial-gradient(circle at 35% 35%,rgba(255,255,255,.35),transparent 65%);
}
.pika-info { flex:1; }
.pika-name {
  font-size:14px; font-weight:700; color:#ffe04a;
  display:flex; align-items:center; gap:6px;
}
.pika-name .online-dot {
  width:7px; height:7px; border-radius:50%; background:#3ddc84;
  animation:blink 2s infinite;
}
.pika-role {
  font-family:'JetBrains Mono',monospace;
  font-size:9px; color:rgba(255,220,100,.45); letter-spacing:1.5px; text-transform:uppercase;
}
.pika-close {
  background:rgba(255,255,255,.06); border:none; border-radius:8px;
  width:28px; height:28px; cursor:pointer; color:rgba(255,255,255,.4);
  font-size:14px; display:flex; align-items:center; justify-content:center;
  transition:all .2s;
}
.pika-close:hover{background:rgba(255,92,92,.15);color:#ff5c5c;}

/* Messages */
.pika-messages {
  flex:1; overflow-y:auto; padding:16px 14px; display:flex;
  flex-direction:column; gap:12px; min-height:200px; max-height:310px;
  scrollbar-width:thin; scrollbar-color:rgba(255,184,0,.2) transparent;
}
.pika-messages::-webkit-scrollbar{width:4px;}
.pika-messages::-webkit-scrollbar-thumb{background:rgba(255,184,0,.2);border-radius:4px;}

.pika-msg { display:flex; gap:8px; align-items:flex-end; animation:fadeUp .3s ease both; }
.pika-msg.user { flex-direction:row-reverse; }

.msg-avatar {
  width:28px; height:28px; border-radius:50%; flex-shrink:0;
  background:linear-gradient(135deg,#ffe04a,#ffb800);
  display:flex; align-items:center; justify-content:center; font-size:14px;
}
.msg-avatar.user-av {
  background:linear-gradient(135deg,var(--blue),var(--cyan));
  font-size:11px; font-weight:700; color:#000;
}
.msg-bubble {
  max-width:76%; padding:10px 13px; border-radius:16px; font-size:12.5px;
  font-family:'JetBrains Mono',monospace; line-height:1.65; word-break:break-word;
}
.pika-msg.bot .msg-bubble {
  background:rgba(255,184,0,.08); border:1px solid rgba(255,184,0,.18);
  color:rgba(255,230,150,.9); border-radius:16px 16px 16px 4px;
}
.pika-msg.user .msg-bubble {
  background:rgba(62,240,255,.08); border:1px solid rgba(62,240,255,.2);
  color:rgba(200,240,255,.9); border-radius:16px 16px 4px 16px;
}

/* Typing indicator */
.typing-dots { display:flex; gap:4px; padding:4px 2px; }
.typing-dots span {
  width:6px; height:6px; border-radius:50%; background:#ffe04a;
  animation:typingBounce .9s ease-in-out infinite;
}
.typing-dots span:nth-child(2){animation-delay:.15s;}
.typing-dots span:nth-child(3){animation-delay:.3s;}
@keyframes typingBounce{0%,80%,100%{transform:translateY(0);opacity:.4}40%{transform:translateY(-6px);opacity:1}}

/* Quick chips */
.pika-quick {
  padding:8px 14px; border-top:1px solid rgba(255,184,0,.08);
  display:flex; gap:6px; flex-wrap:wrap;
}
.q-chip {
  font-family:'JetBrains Mono',monospace; font-size:9.5px;
  padding:4px 10px; border-radius:100px; cursor:pointer;
  background:rgba(255,184,0,.07); border:1px solid rgba(255,184,0,.2);
  color:rgba(255,220,100,.7); transition:all .18s; white-space:nowrap;
}
.q-chip:hover{background:rgba(255,184,0,.15);color:#ffe04a;}

/* Input row */
.pika-input-row {
  padding:10px 12px; border-top:1px solid rgba(255,184,0,.1);
  display:flex; gap:8px; align-items:center;
  background:rgba(0,0,0,.2);
}
.pika-input {
  flex:1; background:rgba(255,255,255,.04); border:1px solid rgba(255,184,0,.15);
  border-radius:10px; padding:9px 12px; color:var(--text);
  font-family:'JetBrains Mono',monospace; font-size:12px; outline:none;
  transition:border-color .2s;
}
.pika-input::placeholder{color:rgba(255,220,100,.25);}
.pika-input:focus{border-color:rgba(255,184,0,.4);}
.pika-send {
  width:34px; height:34px; border-radius:10px; border:none; cursor:pointer;
  background:linear-gradient(135deg,#ffe04a,#ffb800);
  color:#000; font-size:14px; display:flex; align-items:center; justify-content:center;
  transition:transform .2s,box-shadow .2s; flex-shrink:0;
}
.pika-send:hover{transform:scale(1.08);box-shadow:0 4px 14px rgba(255,184,0,.4);}
.pika-send:disabled{opacity:.4;cursor:not-allowed;transform:none;}

@media(max-width:420px){
  #pika-panel{width:calc(100vw - 24px); right:12px; bottom:92px;}
  #pika-fab{bottom:16px;right:16px;}
}
</style>

<!-- FAB Button -->
<button id="pika-fab" onclick="togglePika()" title="Ask Pikachu!">
  <!-- Pikachu SVG -->
  <svg width="38" height="38" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
    <!-- ears -->
    <polygon points="20,38 8,4 35,24" fill="#2a2a2a"/>
    <polygon points="20,38 12,14 33,26" fill="#ffe04a"/>
    <polygon points="80,38 92,4 65,24" fill="#2a2a2a"/>
    <polygon points="80,38 88,14 67,26" fill="#ffe04a"/>
    <!-- face -->
    <ellipse cx="50" cy="58" rx="38" ry="34" fill="#ffe04a"/>
    <!-- cheeks -->
    <ellipse cx="22" cy="68" rx="10" ry="7" fill="#ff6b6b" opacity=".85"/>
    <ellipse cx="78" cy="68" rx="10" ry="7" fill="#ff6b6b" opacity=".85"/>
    <!-- eyes -->
    <ellipse cx="36" cy="52" rx="7" ry="8" fill="#1a1a1a"/>
    <ellipse cx="64" cy="52" rx="7" ry="8" fill="#1a1a1a"/>
    <ellipse cx="38" cy="50" rx="2.5" ry="3" fill="white"/>
    <ellipse cx="66" cy="50" rx="2.5" ry="3" fill="white"/>
    <!-- nose -->
    <ellipse cx="50" cy="63" rx="2.5" ry="1.5" fill="#c8860a"/>
    <!-- mouth -->
    <path d="M42 70 Q50 77 58 70" stroke="#c8860a" stroke-width="2.5" fill="none" stroke-linecap="round"/>
  </svg>
  <div class="pika-badge">âœ¦</div>
</button>

<!-- Chat Panel -->
<div id="pika-panel" class="hidden">
  <div class="pika-header">
    <div class="pika-avatar">
      <svg width="28" height="28" viewBox="0 0 100 100">
        <polygon points="20,38 8,4 35,24" fill="#2a2a2a"/>
        <polygon points="20,38 12,14 33,26" fill="#ffe04a"/>
        <polygon points="80,38 92,4 65,24" fill="#2a2a2a"/>
        <polygon points="80,38 88,14 67,26" fill="#ffe04a"/>
        <ellipse cx="50" cy="58" rx="38" ry="34" fill="#ffe04a"/>
        <ellipse cx="22" cy="68" rx="10" ry="7" fill="#ff6b6b" opacity=".85"/>
        <ellipse cx="78" cy="68" rx="10" ry="7" fill="#ff6b6b" opacity=".85"/>
        <ellipse cx="36" cy="52" rx="7" ry="8" fill="#1a1a1a"/>
        <ellipse cx="64" cy="52" rx="7" ry="8" fill="#1a1a1a"/>
        <ellipse cx="38" cy="50" rx="2.5" ry="3" fill="white"/>
        <ellipse cx="66" cy="50" rx="2.5" ry="3" fill="white"/>
        <ellipse cx="50" cy="63" rx="2.5" ry="1.5" fill="#c8860a"/>
        <path d="M42 70 Q50 77 58 70" stroke="#c8860a" stroke-width="2.5" fill="none" stroke-linecap="round"/>
      </svg>
    </div>
    <div class="pika-info">
      <div class="pika-name">Pikachu <span class="online-dot"></span></div>
      <div class="pika-role">PromptForge Guide Â· Lv.99</div>
    </div>
    <button class="pika-close" onclick="togglePika()">âœ•</button>
  </div>

  <div class="pika-messages" id="pikaMessages"></div>

  <div class="pika-quick" id="pikaQuick">
    <span class="q-chip" onclick="quickAsk(this)">How do I write better prompts?</span>
    <span class="q-chip" onclick="quickAsk(this)">Which model should I pick?</span>
    <span class="q-chip" onclick="quickAsk(this)">What does the Brain detect?</span>
    <span class="q-chip" onclick="quickAsk(this)">Explain each toggle option</span>
  </div>

  <div class="pika-input-row">
    <input id="pikaInput" class="pika-input" placeholder="Ask Pikachu anythingâ€¦" onkeydown="if(event.key==='Enter')sendPika()"/>
    <button class="pika-send" id="pikaSendBtn" onclick="sendPika()">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M2 21l21-9L2 3v7l15 2-15 2v7z"/></svg>
    </button>
  </div>
</div>

<script>
// â”€â”€ Pikachu assistant â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PIKA_SYSTEM = `You are Pikachu, an adorable and knowledgeable AI assistant built into PromptForge â€” an Intelligent Prompt Optimizer website.

PromptForge features:
- Users type any rough idea or request in the textarea
- The "Brain" auto-detects domain (coding, writing, image, analysis, business, science, education, creative, personal, data), intent (create, explain, analyze, improve, plan, convert), tone (professional, casual, technical, creative, academic), audience (beginner, expert, students, business, general), and output type
- Users pick target AI models: ChatGPT, Claude, Gemini, Midjourney, Llama, Grok
- Toggle options: Depth, Expert Role, Examples, Step-by-step, Format, Constraints
- Click "Optimize My Prompt" to get model-specific optimized prompts
- Each result card shows: raw input vs optimized prompt, word count, power boost multiplier, token estimate

Your personality:
- Cute, enthusiastic, helpful â€” sprinkle "Pika!" or "âš¡" occasionally but not every message
- Expert in prompt engineering, LLMs, and PromptForge specifically
- Keep answers concise but super useful (2-5 sentences max unless asked for more)
- Use simple formatting: emojis, short bullet lists when helpful
- Never say you can't help â€” always find a way to be useful`;

let pikaOpen = false;
let pikaHistory = [];
let pikaGreeted = false;

function togglePika() {
  pikaOpen = !pikaOpen;
  document.getElementById('pika-panel').classList.toggle('hidden', !pikaOpen);
  if (pikaOpen && !pikaGreeted) {
    pikaGreeted = true;
    addPikaMsg('bot', "Pika pika! âš¡ Hi there! I'm Pikachu, your PromptForge guide! I can help you write better prompts, choose the right AI model, and get the most out of every feature. What's on your mind? ğŸ¾");
  }
  if (pikaOpen) setTimeout(() => document.getElementById('pikaInput').focus(), 150);
}

function addPikaMsg(role, text, isTyping = false) {
  const wrap = document.getElementById('pikaMessages');
  const div = document.createElement('div');
  div.className = `pika-msg ${role === 'bot' ? 'bot' : 'user'}`;
  div.innerHTML = `
    <div class="msg-avatar ${role === 'user' ? 'user-av' : ''}">
      ${role === 'bot' 
        ? `<svg width="16" height="16" viewBox="0 0 100 100"><ellipse cx="50" cy="58" rx="38" ry="34" fill="#ffe04a"/><ellipse cx="36" cy="52" rx="7" ry="8" fill="#1a1a1a"/><ellipse cx="64" cy="52" rx="7" ry="8" fill="#1a1a1a"/></svg>`
        : 'U'}
    </div>
    <div class="msg-bubble" id="${isTyping ? 'pika-typing' : ''}">
      ${isTyping ? '<div class="typing-dots"><span></span><span></span><span></span></div>' : escHtml(text)}
    </div>`;
  wrap.appendChild(div);
  wrap.scrollTop = wrap.scrollHeight;
  return div;
}

function escHtml(t){return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>');}

async function sendPika() {
  const inp = document.getElementById('pikaInput');
  const msg = inp.value.trim();
  if (!msg) return;
  inp.value = '';
  document.getElementById('pikaSendBtn').disabled = true;
  document.getElementById('pikaQuick').style.display = 'none';

  addPikaMsg('user', msg);
  pikaHistory.push({ role: 'user', content: msg });

  // Show typing
  const typingEl = addPikaMsg('bot', '', true);

  try {
    const resp = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 1000,
        system: PIKA_SYSTEM,
        messages: pikaHistory
      })
    });
    const data = await resp.json();
    const reply = data.content?.map(b => b.text || '').join('') || "Pika... something went wrong! Try again? âš¡";

    typingEl.remove();
    addPikaMsg('bot', reply);
    pikaHistory.push({ role: 'assistant', content: reply });

    // keep history trimmed
    if (pikaHistory.length > 20) pikaHistory = pikaHistory.slice(-20);
  } catch(e) {
    typingEl.remove();
    addPikaMsg('bot', "Pika! âš¡ Couldn't reach my server right now. Check your connection and try again!");
  }
  document.getElementById('pikaSendBtn').disabled = false;
  document.getElementById('pikaInput').focus();
}

function quickAsk(el) {
  document.getElementById('pikaInput').value = el.textContent;
  sendPika();
}
</script>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  THE BRAIN â€” Pattern Recognition & Context Engine
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const LOGOS = {
  chatgpt:`<svg viewBox="0 0 41 41" fill="white"><path d="M37.532 16.87a9.963 9.963 0 0 0-.856-8.184 10.078 10.078 0 0 0-10.855-4.835 9.964 9.964 0 0 0-6.15-3.765 10.079 10.079 0 0 0-11.498 4.96 9.956 9.956 0 0 0-6.671 4.804 10.08 10.08 0 0 0 1.24 11.817 9.965 9.965 0 0 0 .856 8.185 10.079 10.079 0 0 0 10.855 4.835 9.965 9.965 0 0 0 6.15 3.765 10.079 10.079 0 0 0 11.498-4.96 9.956 9.956 0 0 0 6.671-4.804 10.079 10.079 0 0 0-1.24-11.816zm-17.151 23.707a7.461 7.461 0 0 1-4.787-1.735c.061-.033.168-.091.237-.134l7.943-4.587a1.324 1.324 0 0 0 .666-1.148V22.61l3.356 1.938a.122.122 0 0 1 .066.092v9.299a7.505 7.505 0 0 1-7.481 7.538zm-16.075-6.899a7.46 7.46 0 0 1-.894-5.023c.06.036.162.099.237.141l7.943 4.587a1.324 1.324 0 0 0 1.332 0l9.699-5.602v3.876a.12.12 0 0 1-.048.103l-8.032 4.636a7.504 7.504 0 0 1-10.237-2.718zm-2.09-17.51a7.458 7.458 0 0 1 3.897-3.286 73.928 73.928 0 0 0-.001.278v9.175c0 .47.252.906.666 1.148l9.699 5.601-3.357 1.938a.12.12 0 0 1-.114.012L8.048 25.497a7.503 7.503 0 0 1-5.832-8.429zm27.556 6.437-9.699-5.602 3.356-1.937a.12.12 0 0 1 .114-.012l8.048 4.648a7.498 7.498 0 0 1-1.158 13.528v-9.453a1.324 1.324 0 0 0-.661-1.172zm3.339-5.033c-.059-.037-.162-.099-.236-.141l-7.944-4.587a1.325 1.325 0 0 0-1.332 0l-9.698 5.602v-3.876a.12.12 0 0 1 .048-.103l8.031-4.635a7.499 7.499 0 0 1 11.131 7.74zm-21.063 6.929-3.356-1.938a.121.121 0 0 1-.066-.092v-9.299a7.498 7.498 0 0 1 12.268-5.803 6.268 6.268 0 0 0-.236.134l-7.944 4.587a1.325 1.325 0 0 0-.666 1.148v11.263zm1.822-3.943 4.313-2.49 4.314 2.49v4.979l-4.314 2.49-4.313-2.49V20.758z"/></svg>`,
  claude:`<svg viewBox="0 0 80 80" fill="none"><path d="M40 8L47.2 32.8L72 25.6L54.4 44L72 62.4L47.2 55.2L40 80L32.8 55.2L8 62.4L25.6 44L8 25.6L32.8 32.8L40 8Z" fill="#D4A574"/></svg>`,
  gemini:`<svg viewBox="0 0 28 28"><defs><linearGradient id="gg2" x1="0" y1="0" x2="28" y2="28" gradientUnits="userSpaceOnUse"><stop offset="0%" stop-color="#4285F4"/><stop offset="50%" stop-color="#9B72FF"/><stop offset="100%" stop-color="#EA4335"/></linearGradient></defs><path d="M14 28C14 26.06 13.63 24.24 12.88 22.54C12.16 20.84 11.17 19.36 9.91 18.1C8.65 16.84 7.16 15.85 5.46 15.12C3.76 14.37 1.94 14 0 14C1.94 14 3.76 13.64 5.46 12.91C7.16 12.17 8.65 11.17 9.91 9.91C11.17 8.65 12.16 7.16 12.88 5.46C13.63 3.76 14 1.94 14 0C14 1.94 14.36 3.76 15.09 5.46C15.83 7.16 16.84 8.65 18.1 9.91C19.36 11.17 20.84 12.17 22.54 12.91C24.24 13.64 26.06 14 28 14C26.06 14 24.24 14.37 22.54 15.12C20.84 15.85 19.36 16.84 18.1 18.1C16.84 19.36 15.83 20.84 15.09 22.54C14.36 24.24 14 26.06 14 28Z" fill="url(#gg2)"/></svg>`,
  midjourney:`<svg viewBox="0 0 100 100"><circle cx="50" cy="50" r="8" fill="white"/><circle cx="50" cy="50" r="38" fill="none" stroke="white" stroke-width="5"/><line x1="50" y1="12" x2="50" y2="30" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="50" y1="70" x2="50" y2="88" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="12" y1="50" x2="30" y2="50" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="70" y1="50" x2="88" y2="50" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="23" y1="23" x2="36" y2="36" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="64" y1="64" x2="77" y2="77" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="77" y1="23" x2="64" y2="36" stroke="white" stroke-width="5" stroke-linecap="round"/><line x1="36" y1="64" x2="23" y2="77" stroke="white" stroke-width="5" stroke-linecap="round"/></svg>`,
  llama:`<svg viewBox="0 0 60 30"><defs><linearGradient id="mg2" x1="0" y1="0" x2="60" y2="30" gradientUnits="userSpaceOnUse"><stop offset="0%" stop-color="#0668E1"/><stop offset="100%" stop-color="#0099FF"/></linearGradient></defs><path d="M7 15C7 8.37 10.13 3 14.5 3C17.63 3 20.06 5.16 22.5 9.5L30 22.8L37.5 9.5C39.94 5.16 42.37 3 45.5 3C49.87 3 53 8.37 53 15C53 21.63 49.87 27 45.5 27C42.37 27 39.94 24.84 37.5 20.5L30 7.2L22.5 20.5C20.06 24.84 17.63 27 14.5 27C10.13 27 7 21.63 7 15Z" fill="none" stroke="url(#mg2)" stroke-width="4.5" stroke-linejoin="round"/></svg>`,
  grok:`<svg viewBox="0 0 24 24" fill="white"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-4.714-6.231-5.401 6.231H2.748l7.73-8.835L1.254 2.25H8.08l4.253 5.622 5.911-5.622zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>`
};

// â”€â”€ Domain Detection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DOMAIN_PATTERNS = [
  {id:'coding',        label:'ğŸ’» Coding',        keywords:['code','build','develop','function','api','app','website','react','python','javascript','html','css','bug','debug','script','program','database','sql','component','backend','frontend','node','flask','django','typescript','class','algorithm']},
  {id:'writing',       label:'âœï¸ Writing',        keywords:['write','essay','blog','article','story','poem','letter','email','report','draft','paragraph','content','copywrite','cover letter','cv','resume','narrative','fiction','novel','post','caption','script','speech','proposal']},
  {id:'image',         label:'ğŸ¨ Image/Visual',   keywords:['image','draw','paint','illustrate','render','design','logo','poster','artwork','visual','sketch','portrait','landscape','anime','cartoon','photo','realistic','abstract','wallpaper','icon','banner','generate image','create image','picture']},
  {id:'analysis',      label:'ğŸ” Analysis',       keywords:['analyze','analyse','explain','compare','research','study','evaluate','assess','review','breakdown','investigate','understand','why','how does','what causes','pros and cons','swot','critique','assess','breakdown','summary','summarize']},
  {id:'business',      label:'ğŸ“Š Business',       keywords:['business','startup','strategy','marketing','sales','revenue','pitch','proposal','plan','product','customer','brand','market','competition','growth','monetize','launch','investor','b2b','saas','pricing','ceo','entrepreneur','campaign']},
  {id:'education',     label:'ğŸ“š Education',      keywords:['teach','learn','explain','understand','concept','lesson','course','tutorial','study','beginner','advanced','guide','what is','how to','definition','theory','principle','formula','subject','topic','introduction','overview']},
  {id:'creative',      label:'ğŸŒŸ Creative',       keywords:['creative','brainstorm','idea','concept','imagine','invent','innovate','design','prototype','thinking','divergent','what if','possibilities','generate ideas','creativity','unconventional','unique','original','novel approach']},
  {id:'personal',      label:'ğŸ’¬ Personal',       keywords:['advice','help me','i want','i need','personal','my life','improve','better','habit','goal','motivation','career','relationship','decision','choice','plan my','how should i','recommend','suggest','opinion']},
  {id:'science',       label:'ğŸ”¬ Science',        keywords:['science','physics','chemistry','biology','math','quantum','atom','molecule','equation','theory','experiment','hypothesis','research','discovery','universe','space','climate','evolution','genetics','neuroscience']},
  {id:'data',          label:'ğŸ“ˆ Data/Analytics', keywords:['data','analytics','statistics','chart','graph','dashboard','metric','kpi','visualization','excel','tableau','power bi','pandas','numpy','dataset','analysis','trend','insight','sql query','report']},
];

// â”€â”€ Intent Detection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const INTENT_PATTERNS = [
  {id:'create',   label:'ğŸ›  Create',     keywords:['write','build','create','make','generate','design','develop','code','draw','paint','draft','compose','produce']},
  {id:'explain',  label:'ğŸ’¡ Explain',    keywords:['explain','describe','what is','how does','tell me','define','clarify','elaborate','break down','simplify','summarize','overview']},
  {id:'analyze',  label:'ğŸ” Analyze',    keywords:['analyze','analyse','compare','evaluate','assess','review','critique','examine','investigate','research','study','audit','breakdown']},
  {id:'improve',  label:'â¬†ï¸ Improve',    keywords:['improve','enhance','optimize','fix','refactor','upgrade','revise','edit','polish','strengthen','better','boost']},
  {id:'plan',     label:'ğŸ“‹ Plan',       keywords:['plan','strategy','roadmap','steps','how to','approach','framework','outline','organize','schedule','guide','blueprint']},
  {id:'convert',  label:'ğŸ”„ Convert',    keywords:['convert','translate','transform','rewrite','rephrase','adapt','change','turn into','migrate','refactor']},
];

// â”€â”€ Tone Detection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const TONE_PATTERNS = [
  {id:'professional', label:'ğŸ‘” Professional', keywords:['professional','formal','business','corporate','official','polished','executive','enterprise','client','stakeholder','linkedin','resume','cover letter','report','proposal']},
  {id:'casual',       label:'ğŸ˜Š Casual',       keywords:['simple','easy','casual','fun','friendly','informal','quick','short','chill','relax','everyday','plain','straightforward']},
  {id:'technical',    label:'âš™ï¸ Technical',    keywords:['technical','advanced','detailed','in-depth','expert','engineering','architecture','implementation','specification','system','infrastructure','algorithm','complexity']},
  {id:'creative',     label:'ğŸ­ Creative',     keywords:['creative','imaginative','artistic','poetic','fictional','storytelling','narrative','metaphor','vivid','expressive','experimental','unconventional']},
  {id:'academic',     label:'ğŸ“ Academic',     keywords:['academic','scholarly','research','scientific','thesis','peer-reviewed','citation','literature','theoretical','empirical','methodology','hypothesis']},
];

// â”€â”€ Audience Detection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const AUDIENCE_PATTERNS = [
  {id:'beginner',    label:'ğŸŒ± Beginner',      keywords:['beginner','simple','basic','introduction','newbie','never done','first time','no experience','easy','layman','non-technical','5 year old','eli5','novice']},
  {id:'expert',      label:'ğŸ§ª Expert',        keywords:['expert','advanced','professional','senior','deep dive','sophisticated','cutting edge','complex','nuanced','technical depth','experienced','specialized']},
  {id:'students',    label:'ğŸ’ Students',      keywords:['student','learn','school','college','university','class','homework','assignment','study','exam','academic','education']},
  {id:'business',    label:'ğŸ’¼ Business',      keywords:['ceo','manager','executive','team','company','organization','client','stakeholder','investor','board','enterprise','corporate']},
  {id:'general',     label:'ğŸŒ General',       keywords:['everyone','general','public','anyone','broad','wide audience','all ages','accessible','universal']},
];

// â”€â”€ Output Type Detection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const OUTPUT_PATTERNS = [
  {id:'code',      label:'</> Code',         keywords:['code','function','class','component','api','script','snippet','implementation','algorithm','build','develop','program']},
  {id:'essay',     label:'ğŸ“„ Essay',         keywords:['essay','article','blog','post','paper','writeup','long-form','in-depth piece','content','report']},
  {id:'list',      label:'ğŸ“‹ List',          keywords:['list','bullet','steps','points','items','tips','reasons','examples','recommendations','options','ideas']},
  {id:'email',     label:'ğŸ“§ Email',         keywords:['email','message','outreach','follow-up','newsletter','cold email','letter','correspondence','reply','respond']},
  {id:'image',     label:'ğŸ–¼ Image',         keywords:['image','photo','painting','illustration','artwork','render','visual','drawing','design','poster','logo']},
  {id:'plan',      label:'ğŸ—º Plan/Roadmap',  keywords:['plan','roadmap','strategy','steps','guide','framework','outline','schedule','approach','blueprint','workflow']},
  {id:'explanation',label:'ğŸ’¬ Explanation',  keywords:['explain','clarify','describe','breakdown','simplify','understand','overview','introduction','summary']},
  {id:'analysis',  label:'ğŸ“Š Analysis',      keywords:['analyze','compare','evaluate','assess','pros cons','swot','research','study','breakdown','critique']},
];

// â”€â”€ BRAIN: Analyze Input â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function analyze(raw) {
  const text = raw.toLowerCase();
  const words = text.split(/\s+/);

  function score(patterns) {
    return patterns.map(p => ({
      ...p,
      score: p.keywords.filter(k => text.includes(k)).length
    })).sort((a,b) => b.score - a.score);
  }

  const domain   = score(DOMAIN_PATTERNS)[0]?.score > 0   ? score(DOMAIN_PATTERNS)[0]   : {id:'general',label:'ğŸŒ General'};
  const intent   = score(INTENT_PATTERNS)[0]?.score > 0   ? score(INTENT_PATTERNS)[0]   : {id:'create', label:'ğŸ›  Create'};
  const tone     = score(TONE_PATTERNS)[0]?.score > 0     ? score(TONE_PATTERNS)[0]     : {id:'professional',label:'ğŸ‘” Professional'};
  const audience = score(AUDIENCE_PATTERNS)[0]?.score > 0 ? score(AUDIENCE_PATTERNS)[0] : {id:'general',label:'ğŸŒ General'};
  const output   = score(OUTPUT_PATTERNS)[0]?.score > 0   ? score(OUTPUT_PATTERNS)[0]   : {id:'explanation',label:'ğŸ’¬ Explanation'};

  // Extract key subject phrase (remove common openers)
  const subject = raw.trim()
    .replace(/^(please\s+)?(can you\s+)?(help me\s+)?(i want (to|you to)\s+)?(write|create|build|make|generate|design|explain|analyze|tell me about|describe)\s+(a|an|the)?\s*/i,'')
    .trim();

  // Detect specific entities (job titles, technologies, topics)
  const jobMatch = raw.match(/\b(engineer|developer|designer|manager|analyst|writer|doctor|teacher|marketer|founder|cto|ceo|product manager|data scientist|devops|architect)\b/i);
  const techMatch = raw.match(/\b(react|vue|angular|python|javascript|typescript|node|django|flask|sql|postgres|mongodb|aws|docker|kubernetes|tailwind|next\.?js|redux|api|rest|graphql)\b/gi);
  const toneSignal = raw.match(/\b(funny|humorous|serious|inspiring|motivational|sarcastic|empathetic|authoritative|friendly|conversational|poetic|dramatic)\b/i);

  return {
    domain, intent, tone, audience, output,
    subject: subject || raw.trim(),
    rawText: raw.trim(),
    jobRole: jobMatch ? jobMatch[0] : null,
    technologies: techMatch ? [...new Set(techMatch.map(t=>t.toLowerCase()))] : [],
    toneOverride: toneSignal ? toneSignal[0] : null,
    isImageTask: ['image','midjourney'].includes(domain.id) || output.id === 'image',
    isCodeTask: domain.id === 'coding' || output.id === 'code',
    isWritingTask: domain.id === 'writing' || ['essay','email'].includes(output.id),
    isAnalysis: domain.id === 'analysis' || intent.id === 'analyze',
  };
}

// â”€â”€ Smart Role Mapper â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getExpertRole(ctx) {
  const d = ctx.domain.id;
  const i = ctx.intent.id;
  if (ctx.jobRole) return `an expert ${ctx.jobRole} career consultant and professional writer`;
  if (ctx.isCodeTask) return 'a senior software engineer with 15+ years of industry experience';
  if (ctx.isImageTask) return 'a professional concept artist and creative director';
  if (d === 'business') return 'a seasoned business strategist and McKinsey-trained consultant';
  if (d === 'science') return 'a PhD researcher and science communicator';
  if (d === 'education') return 'an expert educator specializing in clear, engaging instruction';
  if (d === 'analysis') return 'a critical thinking expert and research analyst';
  if (d === 'personal') return 'a world-class life coach and mentor';
  if (d === 'data') return 'a data scientist and analytics engineer';
  if (ctx.isWritingTask) return 'a professional writer and editor with a decade of publishing experience';
  return 'a domain expert with deep knowledge and practical experience in this subject';
}

// â”€â”€ Smart Context Enrichment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getContextDetails(ctx, opts) {
  const lines = [];

  if (ctx.isCodeTask && ctx.technologies.length > 0) {
    lines.push(`Technologies involved: ${ctx.technologies.join(', ')}`);
  }
  if (ctx.jobRole) lines.push(`Role context: ${ctx.jobRole} position`);
  if (ctx.toneOverride) lines.push(`Tone requirement: ${ctx.toneOverride}`);

  if (opts.detailed) {
    if (ctx.isCodeTask) lines.push(`Include: code with comments, error handling, best practices, and usage examples`);
    else if (ctx.isWritingTask) lines.push(`Include: strong opening hook, structured body, compelling conclusion`);
    else if (ctx.isAnalysis) lines.push(`Include: multiple perspectives, supporting evidence, clear reasoning`);
    else if (ctx.isImageTask) lines.push(`Include: detailed visual descriptors for subject, style, lighting, mood`);
    else lines.push(`Include: background context, key concepts, real-world implications, and takeaways`);
  }
  return lines;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MODEL BUILDERS â€” Use brain context to craft each prompt
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const MODELS = {
  chatgpt:{
    name:'ChatGPT', tag:'GPT-4o',
    build(raw, opts, ctx) {
      const role = getExpertRole(ctx);
      const extra = getContextDetails(ctx, opts);
      const lines = [];

      if (opts.roleplay) {
        lines.push(`You are ${role}.`,'');
      }

      // Intent-driven task framing
      if (ctx.intent.id === 'create') lines.push(`Your task: Create ${ctx.subject}.`,'');
      else if (ctx.intent.id === 'explain') lines.push(`Your task: Provide a clear, thorough explanation of ${ctx.subject}.`,'');
      else if (ctx.intent.id === 'analyze') lines.push(`Your task: Conduct a comprehensive analysis of ${ctx.subject}.`,'');
      else if (ctx.intent.id === 'improve') lines.push(`Your task: Improve and optimize the following: ${ctx.subject}.`,'');
      else if (ctx.intent.id === 'plan') lines.push(`Your task: Develop a detailed, actionable plan for ${ctx.subject}.`,'');
      else lines.push(`Your task: ${cap(raw.trim())}.`,'');

      if (extra.length) { lines.push(...extra,''); }

      if (opts.detailed) {
        if (ctx.isCodeTask) {
          lines.push('Your response must include:',
            '- Clean, well-commented, production-ready code',
            '- Explanation of the architecture and key design decisions',
            '- Edge case handling and error management',
            '- Usage examples with sample inputs/outputs',
            '- Any dependencies or setup requirements','');
        } else if (ctx.isWritingTask) {
          lines.push('Your response must include:',
            '- A compelling, attention-grabbing opening',
            '- Well-structured body with clear logical flow',
            '- Concrete evidence, examples, or anecdotes',
            '- Professional tone calibrated to the audience',
            '- Strong, memorable closing with a clear call to action','');
        } else if (ctx.isAnalysis) {
          lines.push('Your response must include:',
            '- A structured breakdown of all key dimensions',
            '- Multiple viewpoints and perspectives',
            '- Supporting data, evidence, or examples',
            '- Critical evaluation of strengths and weaknesses',
            '- A clear, reasoned conclusion','');
        } else {
          lines.push('Your response must include:',
            '- Thorough coverage of all relevant aspects',
            '- Key background context the reader needs',
            '- Practical applications and real-world relevance',
            '- Important nuances, caveats, or exceptions','');
        }
      }

      if (opts.examples) lines.push(`Include at least 2â€“3 specific, well-chosen examples that illustrate the core concepts concretely.`,'');
      if (opts.steps)    lines.push(`Structure your response as a numbered, step-by-step guide that a reader can follow sequentially.`,'');

      if (opts.constraints) {
        lines.push('Constraints:',
          '- Be accurate and factual â€” no hallucination',
          `- Audience: ${ctx.audience.label.replace(/.*? /,'')} â€” calibrate complexity accordingly`,
          '- Avoid filler, padding, and repetitive phrasing','');
      }

      if (opts.format) {
        lines.push('Output Format:',
          '- Use ## headers to organize major sections',
          '- Use bullet points for lists and sub-points',
          '- Bold key terms and important takeaways',
          ctx.isCodeTask ? '- Wrap all code in proper markdown code blocks' : '- End with a concise "Key Takeaways" section');
      }

      return lines.join('\n');
    }
  },

  claude:{
    name:'Claude', tag:'Anthropic',
    build(raw, opts, ctx) {
      const role = getExpertRole(ctx);
      const extra = getContextDetails(ctx, opts);
      const lines = [];

      lines.push('<context>');
      lines.push(`You are ${role}. Your goal is to deliver an exceptionally thorough, insightful, and useful response.`);
      lines.push(`Domain: ${ctx.domain.label} | Intent: ${ctx.intent.label} | Tone: ${ctx.tone.label} | Audience: ${ctx.audience.label}`);
      if (ctx.technologies.length) lines.push(`Technologies in scope: ${ctx.technologies.join(', ')}`);
      lines.push('</context>','');

      lines.push('<task>');
      lines.push(cap(raw.trim()) + '.');
      if (opts.detailed) {
        if (ctx.isCodeTask) lines.push('Provide complete, working code with thorough explanation of every major decision. Include architecture overview, usage examples, and any important caveats.');
        else if (ctx.isWritingTask) lines.push('Craft a polished, compelling piece. Consider the reader\'s perspective, emotional resonance, and practical utility. Every sentence should serve a purpose.');
        else if (ctx.isAnalysis) lines.push('Conduct a rigorous, multi-dimensional analysis. Explore the topic from multiple angles, weigh conflicting viewpoints, and arrive at well-reasoned conclusions.');
        else lines.push('Be comprehensive â€” cover the full depth of this topic, including foundational concepts, nuanced details, practical implications, and real-world context.');
      }
      lines.push('</task>','');

      if (opts.roleplay) {
        lines.push('<persona>');
        lines.push(`Respond with the authority, insight, and depth of ${role}. Demonstrate mastery through specific knowledge, not just general principles.`);
        lines.push('</persona>','');
      }

      const instrs = [];
      if (opts.steps)       instrs.push('- Walk through the content step by step, maintaining clear logical progression');
      if (opts.examples)    instrs.push('- Ground every key point with a concrete, specific, real-world example');
      if (opts.constraints) instrs.push(`- Calibrate depth and vocabulary for a ${ctx.audience.id} audience â€” no condescension, no unnecessary jargon`);
      if (ctx.isCodeTask)   instrs.push('- Explain the "why" behind each architectural and implementation choice');
      if (ctx.isWritingTask)instrs.push('- Prioritize clarity, flow, and impact â€” edit ruthlessly for quality');

      if (instrs.length) { lines.push('<instructions>', ...instrs, '</instructions>',''); }
      if (extra.length)  { lines.push('<additional_context>', ...extra.map(e=>`- ${e}`), '</additional_context>',''); }

      if (opts.format) {
        lines.push('<format>');
        if (ctx.isCodeTask) lines.push('Provide: (1) Brief architectural overview, (2) Complete commented code, (3) Usage examples, (4) Key considerations or gotchas.');
        else lines.push('Structure with clear markdown headers. Use bullet points for lists. End with a summary section highlighting the single most important insight.');
        lines.push('</format>');
      }

      return lines.join('\n');
    }
  },

  gemini:{
    name:'Gemini', tag:'Google',
    build(raw, opts, ctx) {
      const role = getExpertRole(ctx);
      const extra = getContextDetails(ctx, opts);
      const lines = [];

      if (opts.roleplay) lines.push(`Role: You are ${role}.`,'');

      lines.push(`Task: ${cap(raw.trim())}`, '');
      lines.push(`Context:`,
        `- Domain: ${ctx.domain.label.replace(/.*? /,'')}`,
        `- Goal: ${ctx.intent.label.replace(/.*? /,'')}`,
        `- Audience: ${ctx.audience.label.replace(/.*? /,'')}`,
        `- Desired output: ${ctx.output.label.replace(/.*? /,'')}`, '');

      if (extra.length) { lines.push('Additional context:', ...extra.map(e=>`- ${e}`),''); }

      lines.push('Requirements:');
      let n = 1;
      if (opts.detailed) {
        if (ctx.isCodeTask)    lines.push(`${n++}. Provide complete, working, well-commented code. Include architecture rationale and edge case handling.`);
        else if (ctx.isWritingTask) lines.push(`${n++}. Write a complete, polished piece with a strong opening, structured body, and clear conclusion.`);
        else if (ctx.isAnalysis)    lines.push(`${n++}. Deliver a rigorous, multi-angle analysis with evidence-backed conclusions.`);
        else                        lines.push(`${n++}. Cover this topic comprehensively â€” background, core concepts, significance, and practical takeaways.`);
      }
      if (opts.examples)    lines.push(`${n++}. Provide ${ctx.isCodeTask?'working code examples':'concrete real-world examples'} that make the content tangible.`);
      if (opts.steps)       lines.push(`${n++}. Structure as a numbered, step-by-step guide in clear logical order.`);
      if (opts.constraints) lines.push(`${n++}. Maintain strict factual accuracy. No speculation. Calibrate language for ${ctx.audience.id} audience.`);
      if (opts.format)      lines.push(`${n++}. Use ${ctx.isCodeTask?'code blocks, inline comments, and structured sections':'headers, bullets, and a key takeaways summary'} for clarity.`);
      if (n===1)            lines.push(`${n++}. Be thorough, accurate, and immediately useful.`);

      return lines.join('\n');
    }
  },

  midjourney:{
    name:'Midjourney', tag:'Image AI',
    build(raw, opts, ctx) {
      // Clean subject
      const subject = raw.trim()
        .replace(/^(create|generate|make|draw|design|paint|render|illustrate)\s+(a|an|the)?\s*/i,'')
        .trim();

      const parts = [];

      // Core subject â€” expanded with context
      parts.push(cap(subject));

      // Art style based on detected tone/domain
      if (ctx.tone.id === 'creative') parts.push('surreal, imaginative composition','dreamlike atmosphere');
      else if (ctx.tone.id === 'professional') parts.push('clean professional aesthetic','polished presentation');
      else if (ctx.tone.id === 'academic') parts.push('diagrammatic style','clear scientific illustration');
      else parts.push('photorealistic render','hyperdetailed');

      // Visual quality
      if (opts.detailed) parts.push('intricate fine detail','ultra-high resolution','8K UHD','sharp focus');

      // Lighting
      parts.push('cinematic volumetric lighting','dramatic shadows','golden ratio composition');

      // Medium / style
      if (ctx.domain.id === 'image') {
        parts.push('digital concept art','trending on ArtStation','award-winning photography style');
      }
      if (opts.examples) parts.push('painterly finish','inspired by master illustrators');
      if (opts.roleplay) parts.push('by a professional concept artist','published in Spectrum Fantastic Art');

      // Mood & color
      parts.push('vivid saturated colors','atmospheric depth','emotional resonance');

      const neg = '--no blur, noise, low quality, watermark, text, signature, cropped, deformed, ugly, bad anatomy';
      const params = ['--ar 16:9','--v 6.1','--q 2'];
      if (opts.detailed) params.push('--style raw');

      return parts.join(', ') + '\n\n' + neg + '\n' + params.join(' ');
    }
  },

  llama:{
    name:'Llama', tag:'Meta AI',
    build(raw, opts, ctx) {
      const role = getExpertRole(ctx);
      const extra = getContextDetails(ctx, opts);
      const lines = [`[INST]`, ''];

      if (opts.roleplay) lines.push(`You are ${role}. Provide an authoritative, expert-level response.`,'');

      // Intent-driven framing
      if (ctx.intent.id === 'create')  lines.push(`Create ${ctx.subject}.`,'');
      else if (ctx.intent.id === 'explain') lines.push(`Explain ${ctx.subject} clearly and thoroughly.`,'');
      else if (ctx.intent.id === 'analyze') lines.push(`Analyze ${ctx.subject} comprehensively.`,'');
      else lines.push(`${cap(raw.trim())}.`,'');

      if (extra.length) lines.push('Context:', ...extra.map(e=>`- ${e}`),'');

      const reqs = [];
      if (opts.detailed) {
        if (ctx.isCodeTask) reqs.push('- Write complete, working code with inline comments explaining key logic');
        else if (ctx.isWritingTask) reqs.push('- Craft a complete, well-structured piece from start to finish');
        else reqs.push('- Provide comprehensive coverage: background, core concepts, and practical implications');
      }
      if (opts.steps)       reqs.push('- Break down into numbered, ordered steps');
      if (opts.examples)    reqs.push('- Include specific, concrete examples throughout');
      if (opts.constraints) reqs.push(`- Calibrate for ${ctx.audience.id} audience. Be factual and precise.`);
      if (opts.format)      reqs.push('- Use clear headers and bullet points. End with key takeaways.');
      if (reqs.length) lines.push('Requirements:', ...reqs,'');

      lines.push('[/INST]');
      return lines.join('\n');
    }
  },

  grok:{
    name:'Grok', tag:'xAI',
    build(raw, opts, ctx) {
      const role = getExpertRole(ctx);
      const lines = [];

      if (opts.roleplay) lines.push(`You're Grok. Channel the mindset of ${role}. Be direct, sharp, insightful.`,'');

      // Punchy, direct task statement
      if (ctx.intent.id === 'create')  lines.push(`Build this: ${ctx.subject}.`,'');
      else if (ctx.intent.id === 'explain') lines.push(`Explain this properly: ${ctx.subject}.`,'');
      else if (ctx.intent.id === 'analyze') lines.push(`Break this down: ${ctx.subject}.`,'');
      else lines.push(`${cap(raw.trim())}.`,'');

      if (ctx.technologies.length) lines.push(`Tech context: ${ctx.technologies.join(', ')}.`,'');

      if (opts.detailed) {
        if (ctx.isCodeTask)    lines.push('Full implementation. Don\'t skip parts. Comments on non-obvious logic. Error handling. Real usage example.');
        else if (ctx.isWritingTask) lines.push('Complete piece. Strong opening that hooks. Tight structure. No filler sentences. Punchy ending.');
        else if (ctx.isAnalysis)   lines.push('Go deep. Multiple angles. Back every claim. Challenge assumptions. What\'s the real insight here?');
        else lines.push('Full depth. Not just surface. Background + core + implications + what actually matters.');
      }
      if (opts.examples)    lines.push('Real examples only. No vague hypotheticals.');
      if (opts.steps)       lines.push('Step by step. Numbered. In logical order.');
      if (opts.constraints) lines.push(`Audience: ${ctx.audience.id}. No hallucination. Tight writing only.`);
      if (opts.format)      lines.push('Structure it. Headers. Bullets. Clear sections. Make it scannable.');

      return lines.join('\n');
    }
  }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  UI LOGIC
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function cap(s){ return s ? s.charAt(0).toUpperCase()+s.slice(1) : s; }
function wc(t) { return t.trim().split(/\s+/).filter(Boolean).length; }
function esc(t){ return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

let analysisTimer = null;
const rawTA = document.getElementById('raw');

rawTA.addEventListener('input', function(){
  document.getElementById('chars').textContent = `${this.value.length} / 1200`;
  clearTimeout(analysisTimer);
  if (this.value.trim().length > 8) {
    analysisTimer = setTimeout(()=>updateAnalysisStrip(this.value), 350);
  } else {
    document.getElementById('anaStrip').classList.remove('show');
  }
});

function updateAnalysisStrip(text) {
  const ctx = analyze(text);
  document.getElementById('anaDomain').textContent   = ctx.domain.label;
  document.getElementById('anaIntent').textContent   = ctx.intent.label;
  document.getElementById('anaTone').textContent     = ctx.tone.label;
  document.getElementById('anaAudience').textContent = ctx.audience.label;
  document.getElementById('anaOutput').textContent   = ctx.output.label;
  document.getElementById('anaStrip').classList.add('show');
}

document.querySelectorAll('.m-btn').forEach(b => b.addEventListener('click', ()=> b.classList.toggle('active')));
document.querySelectorAll('.chip').forEach(c => c.addEventListener('click', ()=> c.classList.toggle('on')));

function getOpts(){ const o={}; document.querySelectorAll('.chip').forEach(c=>o[c.dataset.opt]=c.classList.contains('on')); return o; }
function getModels(){ return [...document.querySelectorAll('.m-btn.active')].map(b=>b.dataset.m); }

function tryExample(el){
  rawTA.value = el.textContent;
  rawTA.dispatchEvent(new Event('input'));
  rawTA.scrollIntoView({behavior:'smooth',block:'center'});
}

function generate(){
  const raw = rawTA.value.trim();
  if(!raw){
    rawTA.style.borderColor='rgba(255,92,92,.5)'; rawTA.focus();
    setTimeout(()=>rawTA.style.borderColor='',1800); return;
  }
  const models = getModels();
  if(!models.length){ alert('Select at least one AI model.'); return; }

  const btn = document.getElementById('genBtn');
  btn.classList.add('busy');
  btn.querySelector('.btn-txt').textContent = 'Analyzing & optimizing...';

  setTimeout(()=>{
    btn.classList.remove('busy');
    btn.querySelector('.btn-txt').textContent = 'Optimize My Prompt';
    document.getElementById('divider').classList.add('show');

    const opts = getOpts();
    const ctx  = analyze(raw);
    const container = document.getElementById('results');
    container.innerHTML = '';

    models.forEach((m, i) => {
      const info = MODELS[m]; if(!info) return;
      const optimized = info.build(raw, opts, ctx);
      const inWords = wc(raw), outWords = wc(optimized);
      const boost = (outWords / Math.max(inWords, 1)).toFixed(1);

      const card = document.createElement('div');
      card.className = 'r-card'; card.dataset.m = m;
      card.style.animationDelay = `${i * 0.09}s`;

      card.innerHTML = `
        <div class="c-head">
          <div class="c-model">
            <div class="c-logo">${LOGOS[m]}</div>
            <div><span class="c-mname">${info.name}</span><span class="c-tag">${info.tag}</span></div>
          </div>
          <div class="c-actions">
            <button class="a-btn" onclick="copyCard(this,'out-${m}-${i}')">
              <svg width="11" height="11" viewBox="0 0 16 16" fill="currentColor"><path d="M4 2h8a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V4a2 2 0 012-2zm0 1.5a.5.5 0 00-.5.5v8a.5.5 0 00.5.5h8a.5.5 0 00.5-.5V4a.5.5 0 00-.5-.5H4z"/></svg>
              Copy
            </button>
          </div>
        </div>
        <div class="insight-band">
          <span class="ins-lbl">Brain detected â†’</span>
          <span class="ins-tag">${ctx.domain.label}</span>
          <span class="ins-tag">${ctx.intent.label}</span>
          <span class="ins-tag">${ctx.tone.label}</span>
          <span class="ins-tag">${ctx.audience.label}</span>
          ${ctx.technologies.length ? `<span class="ins-tag">ğŸ”§ ${ctx.technologies.slice(0,3).join(', ')}</span>` : ''}
        </div>
        <div class="c-body">
          <div class="section-raw">
            <div class="sec-label lbl-raw">
              <svg viewBox="0 0 16 16" fill="currentColor"><path d="M2 3.5h12v1.5H2zm0 4h12v1.5H2zm0 4h8v1.5H2z"/></svg>
              Raw input
            </div>
            <div class="raw-text">"${esc(raw)}"</div>
          </div>
          <div class="arrow-row">
            <div class="a-line"></div>
            <div class="a-badge">ğŸ§  Brain-optimized for ${info.name}</div>
            <div class="a-line"></div>
          </div>
          <div class="section-opt">
            <div class="sec-label lbl-opt">
              <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1l1.5 3 3.5.5-2.5 2.5.6 3.5L8 9l-3.1 1.5.6-3.5L3 4.5 6.5 4z"/></svg>
              Optimized prompt â€” paste directly into ${info.name}
            </div>
            <div class="opt-text" id="out-${m}-${i}">${esc(optimized)}</div>
          </div>
        </div>
        <div class="c-foot">
          <div class="stat">Input: <b>${inWords}w</b></div>
          <div class="stat">Output: <b>${outWords}w</b></div>
          <div class="stat">Power boost: <b>${boost}Ã—</b></div>
          <div class="stat">~Tokens: <b>${Math.round(outWords*1.3)}</b></div>
        </div>`;

      container.appendChild(card);
    });

    document.getElementById('results').scrollIntoView({behavior:'smooth',block:'start'});
  }, 520);
}

function copyCard(btn, id){
  const el = document.getElementById(id); if(!el) return;
  navigator.clipboard.writeText(el.textContent).then(()=>{
    btn.classList.add('ok');
    btn.innerHTML = `<svg width="11" height="11" viewBox="0 0 16 16" fill="currentColor"><path d="M13.5 3L6 11 2.5 7.5 1 9l5 5L15 4.5z"/></svg> Copied!`;
    setTimeout(()=>{
      btn.classList.remove('ok');
      btn.innerHTML = `<svg width="11" height="11" viewBox="0 0 16 16" fill="currentColor"><path d="M4 2h8a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V4a2 2 0 012-2zm0 1.5a.5.5 0 00-.5.5v8a.5.5 0 00.5.5h8a.5.5 0 00.5-.5V4a.5.5 0 00-.5-.5H4z"/></svg> Copy`;
    }, 2000);
  });
}

function clearAll(){
  rawTA.value = '';
  document.getElementById('chars').textContent = '0 / 1200';
  document.getElementById('divider').classList.remove('show');
  document.getElementById('anaStrip').classList.remove('show');
  document.getElementById('results').innerHTML = `
    <div class="empty-state">
      <div class="empty-icon">ğŸ§ </div>
      <div class="empty-title">Intelligent Brain â€” Ready</div>
      <div class="empty-sub">Type any idea. The brain detects your <strong style="color:var(--blue)">domain</strong>,
      <strong style="color:var(--purple)">intent</strong>, <strong style="color:var(--green)">tone</strong>,
      and <strong style="color:var(--orange)">audience</strong> â€” then builds a powerful, context-aware prompt.</div>
      <div class="ex-chips">
        <span class="ex-chip" onclick="tryExample(this)">Write a cover letter for a UX designer role</span>
        <span class="ex-chip" onclick="tryExample(this)">Explain quantum entanglement simply</span>
        <span class="ex-chip" onclick="tryExample(this)">Build a React dashboard with dark mode</span>
        <span class="ex-chip" onclick="tryExample(this)">Create a fantasy dragon painting</span>
        <span class="ex-chip" onclick="tryExample(this)">Write a product launch email for a SaaS app</span>
        <span class="ex-chip" onclick="tryExample(this)">Analyze why startups fail in year one</span>
      </div>
    </div>`;
}
</script>
</body>
</html>
